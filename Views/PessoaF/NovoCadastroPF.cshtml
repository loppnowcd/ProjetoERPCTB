@using ProjetoGeanBagattoli.Enums
@model ProjetoGeanBagattoli.Models.PessoaF

@{
    ViewData["Title"] = "Cadastro de Nova Pessoa Física";
}



<h1 class="text-center">@ViewData["Title"]</h1>
<hr />

<div class="row justify-content-md-center">

    <div class="col-md-3">
        <h5 class="text-center">Dados Pessoais</h5>

        <div class="form-group mb-3">
            <label asp-for="Nome" class="control-label"></label>
            <input asp-for="Nome" class="form-control" />
            <span asp-validation-for="Nome" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label asp-for="CPF" class="control-label"></label>
            <input asp-for="CPF" class="form-control" />
            <span asp-validation-for="CPF" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label asp-for="DataNascimento" class="control-label">Data de Nascimento</label>
            <input asp-for="DataNascimento" class="form-control" type="date" />
            <span asp-validation-for="DataNascimento" class="text-danger"></span>
        </div>
    </div>

    <div class="col-md-3">
        <h5 class="text-center">Endereço</h5>

        <div class="form-group mb-3">
            <label asp-for="Endereco.Estado" class="control-label"></label>
            <select id="EstadoSelect" class="form-control" asp-for="Endereco.Estado">
                <option value="">Selecione um Estado</option>
                @foreach (var estadoEnum in Enum.GetValues(typeof(UF)))
                {
                    <option value="@estadoEnum.ToString()">@estadoEnum.ToString()</option>
                }
            </select>
        </div>

        <div class="form-group mb-3">
            <label asp-for="Endereco.Cidade" class="control-label"></label>
            <select id="CidadeSelect" class="form-control" asp-for="Endereco.Cidade" disabled>
                <option>Selecione um estado primeiro</option>
            </select>
        </div>

        <div class="form-group mb-3">
            <label asp-for="Endereco.CEP" class="control-label"></label>
            <input asp-for="Endereco.CEP" class="form-control" />
        </div>

        <div class="form-group mb-3">
            <label asp-for="Endereco.Rua" class="control-label"></label>
            <input asp-for="Endereco.Rua" class="form-control" />
        </div>

        <div class="form-group mb-3">
            <label asp-for="Endereco.Numero" class="control-label"></label>
            <input asp-for="Endereco.Numero" class="form-control" />
        </div>

        <div class="form-group mb-3">
            <label asp-for="Endereco.Bairro" class="control-label"></label>
            <input asp-for="Endereco.Bairro" class="form-control" />
        </div>
    </div>

    <div class="col-md-3">
        <h5 class="text-center">Estado Civil</h5>
        <div class="form-group mb-3">
            <label asp-for="EstadoCivil.EstatusSocial" class="control-label"></label>
            <select id="EstadoCivilSelect" class="form-control" asp-for="EstadoCivil.EstatusSocial">
                <option value="">Selecione o estado civil</option>
                @foreach (var estadoCivilEnum in Enum.GetValues(typeof(EstatSocial)))
                {
                    <option value="@estadoCivilEnum.ToString()">@estadoCivilEnum.ToString()</option>
                }
            </select>
        </div>
        <div class="form-group mb-3">
            <label asp-for="EstadoCivil.NomeConjuge" class="control-label"></label>
            <input asp-for="EstadoCivil.NomeConjuge" class="form-control" />
        </div>
        <div class="form-group mb-3">
            <label asp-for="EstadoCivil.RegimeCasamento" class="control-label"></label>
            <select id="RegimeCasamentoSelect" class="form-control" asp-for="EstadoCivil.RegimeCasamento">
                <option value="">Selecione o regime do casamento</option>
                @foreach (var regimeCasamentoEnum in Enum.GetValues(typeof(RegimCasamento)))
                {
                    <option value="@regimeCasamentoEnum.ToString()">@regimeCasamentoEnum.ToString()</option>
                }
            </select>
        </div>
    </div>
    <div class="col-md-3">
        <h5 class="text-center">Contato</h5>

        <div class="form-group mb-3">
            <label asp-for="Nome" class="control-label"></label>
            <input asp-for="Nome" class="form-control" />
            <span asp-validation-for="Nome" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label asp-for="CPF" class="control-label"></label>
            <input asp-for="CPF" class="form-control" />
            <span asp-validation-for="CPF" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label asp-for="DataNascimento" class="control-label">Data de Nascimento</label>
            <input asp-for="DataNascimento" class="form-control" type="date" />
            <span asp-validation-for="DataNascimento" class="text-danger"></span>
        </div>
    </div>

</div>

<br />

<div class="form-group mt-3 container text-center">
    <input type="submit" value="Salvar Cadastro" class="btn btn-primary" />
</div>


@* A seção de scripts que já tínhamos, permanece igual *@
@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const estadoSelect = document.getElementById('EstadoSelect');
            const cidadeSelect = document.getElementById('CidadeSelect');

            estadoSelect.addEventListener('change', function () {
                const uf = this.value;

                cidadeSelect.innerHTML = '<option>Carregando...</option>';
                cidadeSelect.disabled = true;

                if (uf) {
                    fetch(`/api/Localidade/${uf}`)
                        .then(response => response.json())
                        .then(cidades => {
                            cidadeSelect.innerHTML = '<option value="">Selecione a Cidade</option>';
                            cidades.forEach(cidade => {
                                const option = document.createElement('option');
                                option.value = cidade.nome;
                                option.textContent = cidade.nome;
                                cidadeSelect.appendChild(option);
                            });
                            cidadeSelect.disabled = false;
                        })
                        .catch(error => {
                            console.error('Erro ao buscar cidades:', error);
                            cidadeSelect.innerHTML = '<option>Erro ao carregar cidades</option>';
                        });
                } else {
                    cidadeSelect.innerHTML = '<option>Selecione um estado primeiro</option>';
                    cidadeSelect.disabled = true;
                }
            });
        });
    </script>
}